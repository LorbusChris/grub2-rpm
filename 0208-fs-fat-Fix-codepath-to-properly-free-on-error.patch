From 83543f937a3525ef577c5a6333cb6791aadcee3d Mon Sep 17 00:00:00 2001
From: Vladimir Serbinenko <phcoder@gmail.com>
Date: Sun, 25 Jan 2015 01:27:44 +0100
Subject: [PATCH 208/506] fs/fat: Fix codepath to properly free on error.

Found by: Coverity scan.
---
 grub-core/fs/fat.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/grub-core/fs/fat.c b/grub-core/fs/fat.c
index 79fe864..71537ff 100644
--- a/grub-core/fs/fat.c
+++ b/grub-core/fs/fat.c
@@ -1136,7 +1136,7 @@ grub_fat_label (grub_device_t device, char **label)
   if (! (data->attr & GRUB_FAT_ATTR_DIRECTORY))
     {
       grub_error (GRUB_ERR_BAD_FILE_TYPE, N_("not a directory"));
-      return 0;
+      goto fail;
     }
 
   err = grub_fat_iterate_init (&ctxt);
-- 
2.4.3

