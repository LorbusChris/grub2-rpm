From fbae51dcea91bf5b8d1f11a436867f933d370346 Mon Sep 17 00:00:00 2001
From: Vladimir Serbinenko <phcoder@gmail.com>
Date: Sat, 24 Jan 2015 21:23:25 +0100
Subject: [PATCH 194/506] commands/syslinux: Add missing free.

Found by: Coverity scan.
---
 grub-core/commands/syslinuxcfg.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/grub-core/commands/syslinuxcfg.c b/grub-core/commands/syslinuxcfg.c
index 00ae113..7be28fa 100644
--- a/grub-core/commands/syslinuxcfg.c
+++ b/grub-core/commands/syslinuxcfg.c
@@ -119,7 +119,10 @@ syslinux_file (grub_extcmd_context_t ctxt, const char *filename)
     {
       menu = grub_zalloc (sizeof (*menu));
       if (! menu)
-	return grub_errno;
+	{
+	  grub_free (result);
+	  return grub_errno;
+	}
 
       grub_env_set_menu (menu);
     }
-- 
2.4.3

