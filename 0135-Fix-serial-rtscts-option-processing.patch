From bac5d1a64ab4191058a8fd4c05f6b3b339e249e7 Mon Sep 17 00:00:00 2001
From: Andrei Borzenkov <arvidjaar@gmail.com>
Date: Tue, 9 Dec 2014 21:41:49 +0300
Subject: [PATCH 135/506] Fix serial --rtscts option processing

---
 ChangeLog               | 5 +++++
 grub-core/term/serial.c | 4 ++--
 2 files changed, 7 insertions(+), 2 deletions(-)

diff --git a/ChangeLog b/ChangeLog
index 4150810..c38917b 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -1,3 +1,8 @@
+2014-12-09  Andrei Borzenkov  <arvidjaar@gmail.com>
+
+	* grub-core/term/serial.c (grub_cmd_serial): Fix --rtscts
+	option processing.
+
 2014-12-07  David Kozub  <zub.272@gmail.com>
 
 	* grub-core/kern/arm/misc.S: fix unaligned 64bit local variable
diff --git a/grub-core/term/serial.c b/grub-core/term/serial.c
index c9b5574..5784bc2 100644
--- a/grub-core/term/serial.c
+++ b/grub-core/term/serial.c
@@ -241,9 +241,9 @@ grub_cmd_serial (grub_extcmd_context_t ctxt, int argc, char **args)
 
   if (state[OPTION_RTSCTS].set)
     {
-      if (grub_strcmp (state[OPTION_PARITY].arg, "on") == 0)
+      if (grub_strcmp (state[OPTION_RTSCTS].arg, "on") == 0)
 	config.rtscts = 1;
-      if (grub_strcmp (state[OPTION_PARITY].arg, "off") == 0)
+      else if (grub_strcmp (state[OPTION_RTSCTS].arg, "off") == 0)
 	config.rtscts = 0;
       else
 	return grub_error (GRUB_ERR_BAD_ARGUMENT,
-- 
2.4.3

