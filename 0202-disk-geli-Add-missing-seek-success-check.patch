From 6f43e350ed1d122a35c6b1880f6e1756455f0a6c Mon Sep 17 00:00:00 2001
From: Vladimir Serbinenko <phcoder@gmail.com>
Date: Sat, 24 Jan 2015 21:46:23 +0100
Subject: [PATCH 202/506] disk/geli: Add missing seek success check.

Found by: Coverity scan.
---
 grub-core/disk/geli.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/grub-core/disk/geli.c b/grub-core/disk/geli.c
index 4ed07bb..bf73fbd 100644
--- a/grub-core/disk/geli.c
+++ b/grub-core/disk/geli.c
@@ -212,7 +212,8 @@ grub_util_get_geli_uuid (const char *dev)
 
   s = grub_util_get_fd_size (fd, dev, &log_secsize);
   s >>= log_secsize;
-  grub_util_fd_seek (fd, (s << log_secsize) - 512);
+  if (grub_util_fd_seek (fd, (s << log_secsize) - 512) < 0)
+    grub_util_error ("%s", _("couldn't read ELI metadata"));
 
   uuid = xmalloc (GRUB_MD_SHA256->mdlen * 2 + 1);
   if (grub_util_fd_read (fd, (void *) &hdr, 512) < 0)
-- 
2.4.3

