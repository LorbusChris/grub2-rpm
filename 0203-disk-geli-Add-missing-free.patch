From 7656b72b17c3bf12a3e2173fc04aebf67b286983 Mon Sep 17 00:00:00 2001
From: Vladimir Serbinenko <phcoder@gmail.com>
Date: Sat, 24 Jan 2015 21:47:51 +0100
Subject: [PATCH 203/506] disk/geli: Add missing free.

Found by: Coverity scan.
---
 grub-core/disk/geli.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/grub-core/disk/geli.c b/grub-core/disk/geli.c
index bf73fbd..e9d2329 100644
--- a/grub-core/disk/geli.c
+++ b/grub-core/disk/geli.c
@@ -232,7 +232,10 @@ grub_util_get_geli_uuid (const char *dev)
 
   err = make_uuid ((void *) &hdr, uuid);
   if (err)
-    return NULL;
+    {
+      grub_free (uuid);
+      return NULL;
+    }
 
   return uuid;
 }
-- 
2.4.3

