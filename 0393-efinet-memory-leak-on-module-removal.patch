From 8d3c4544ffdd0289a4b0bdeb0cdc6355f801a4b3 Mon Sep 17 00:00:00 2001
From: Andrei Borzenkov <arvidjaar@gmail.com>
Date: Mon, 4 May 2015 08:08:57 +0300
Subject: [PATCH 393/506] efinet: memory leak on module removal

---
 grub-core/net/drivers/efi/efinet.c | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/grub-core/net/drivers/efi/efinet.c b/grub-core/net/drivers/efi/efinet.c
index f171f20..eb1e682 100644
--- a/grub-core/net/drivers/efi/efinet.c
+++ b/grub-core/net/drivers/efi/efinet.c
@@ -278,6 +278,12 @@ GRUB_MOD_FINI(efinet)
 
   FOR_NET_CARDS_SAFE (card, next) 
     if (card->driver == &efidriver)
-      grub_net_card_unregister (card);
+      {
+	grub_net_card_unregister (card);
+	grub_free (card->txbuf);
+	grub_free (card->rcvbuf);
+	grub_free (card->name);
+	grub_free (card);
+      }
 }
 
-- 
2.4.3

